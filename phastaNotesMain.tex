\documentclass[12pt, letterpaper, twoside]{article}
\usepackage[margin=2.50cm]{geometry} % Makes the Margins not stupid
\usepackage{bm} % for making bold equation variables
\usepackage{graphicx} % for placing images
\usepackage{float} % for making figure stay in place
\usepackage{amssymb} % for \lessapprox symbol
\usepackage{amsmath} % because using math and \text command in math mode
\usepackage[numbers]{natbib}
\usepackage{cancel} % for doing a diagonal slash cancel
\usepackage[mathscr]{euscript} % for Fancy curly F
\usepackage{cleveref} % for \cref
\usepackage{commath} % for \od, \pd

\title{Notes on the Fundamental Equations of PHASTA}
\author{James Wright}
% \date{2019-01-21}

%------------ MACROS ----------------
\newcommand{\etot}{e_{tot}}
\renewcommand{\vec}[1]{\bm{#1}}
\newcommand{\U}{\vec{U}}
\newcommand{\Y}{\vec{Y}}
\newcommand{\F}{\vec{F}}
\newcommand{\W}{\vec{W}}
\newcommand{\0}{\vec{0}}
\newcommand{\x}{\vec{x}}
\newcommand{\src}{\vec{\mathscr{F}}}

\begin{document}
\maketitle

\section{Shorthand}
    \begin{equation}
        \phi_{,t} = \frac{\partial \phi}{\partial t}
    \end{equation}

    \begin{equation}
        \phi_{,i} = \frac{\partial \phi}{\partial x_i}
    \end{equation}

    \begin{equation}
        u_{i,t} = \frac{\partial u_i}{\partial t}
    \end{equation}

    \begin{equation}
        u_{i,j} = \frac{\partial u_i}{\partial x_j}
    \end{equation}

    \begin{equation}
        \left[\phi u_i \right]_{,j} = \frac{\partial \phi u_i}{\partial x_j}
    \end{equation}

\section{Fundamental Fluid Equations}
Unsteady Compressible Navier-Stokes (UCNS) equations:

    \subsection{Traditional Form}
    \paragraph{Continuity}
        \begin{equation}\label{eq:fund_continuity}
            \rho_{,t} + \left[\rho u_j \right]_{,j} = 0
        \end{equation}

    \paragraph{Momentum}
        \begin{equation}\label{eq:fund_momentum}
            \left[\rho u_i \right]_{,t} + \left[\rho u_i u_j \right]_{,j} + p_{,i} = \tau_{ij,j} + b_i
        \end{equation}
        
    \paragraph{Energy}
        \begin{equation}\label{eq:fund_energy}
            \left[\rho \etot \right]_{,t} + 
            \left[\rho \etot u_j \right]_{,j} + \left[\rho u_j \right]_{,j} 
            = \left[\tau_{ij} u_j \right]_{,j} + b_i u_j + r + q_{i,i}
        \end{equation}
    
    \subsection{Conservative Vectorized Form}

    \begin{equation}
        \U \equiv
        \begin{Bmatrix}
            \rho \\
            \rho u_1 \\
            \rho u_2 \\
            \rho u_3 \\
            \rho \etot
        \end{Bmatrix}
        =
        \begin{Bmatrix}
            \rho \\
            \rho u_j \\
            \rho \etot
        \end{Bmatrix}
    \end{equation}

    Flux Vector:

    \begin{equation}
        \begin{split}
        \F_i & = 
        \underbrace{
        \begin{Bmatrix}
            \rho u_i \\
            \rho u_i u_j \\
            \rho u_i \etot
        \end{Bmatrix}
        + \begin{Bmatrix}
            0 \\
            p \delta_{ij}\\
            u_i p
        \end{Bmatrix} }_{\text{Advective Flux}}
        - \underbrace{ \begin{Bmatrix}
            0 \\
            \tau_{ij}\\
            \tau_{ij} u_j 
        \end{Bmatrix}
        + \begin{Bmatrix}
            0 \\
            \0 \\
            q_{i,i}
        \end{Bmatrix} }_{\text{Diffusive Flux}} \\
        & = \F_i^{\text{adv}} + \F_i^{\text{dif}}
        \end{split}
    \end{equation}

    Also:
    \begin{equation}
        \F_i^{adv}  = 
        u_i \U
        + \begin{Bmatrix}
            0 \\
            p \delta_{ij}\\
            u_i p
        \end{Bmatrix} 
    \end{equation}

    Source Vector:

    \begin{equation}
        \src = 
        \begin{Bmatrix}
            0 \\
            b_j \\
            b_j u_j + r
        \end{Bmatrix}
    \end{equation}

    These terms combine together to form:
    \begin{equation} \label{eq:vecNS}
        \U_{,t} + \F_{i,i} = \src
    \end{equation}

\section{Finite Element Discretization}

    Before discritizing, we must first setup the UCNS equations. First, rearrange \cref{eq:vecNS} into a residual form:
    \begin{equation}
        \U_{,t} + \F_{i,i} - \src = \0
    \end{equation}

    Next multiply by weight/test functions, \(\W\). Note that \(\0\) is now just a scalar 0.
    \begin{equation}
        \W \cdot ( \U_{,t} + \F_{i,i} - \src )= 0
    \end{equation}

    To create the \textbf{Weak Form} of the NS equations, integrate over the domain \(\Omega\):
    \begin{equation}
        \int_\Omega \W \cdot (\U_{,t} + \F_{i,i} - \src) \dif \Omega= 0
    \end{equation}

    Next, perform integration by parts and Gauss's theorem on \(\F_{i,i}\):
    \begin{equation} \label{eq:weakUCNS_IBP}
        \int_\Omega \left\{\W \cdot \U_{,t} - \W_{,i} \cdot \F_i - \W \cdot \src \right\} \dif \Omega 
        + \int_\Gamma \W \cdot \F_i \cdot \hat n_i \dif\Gamma= 0
    \end{equation}
    where \(\Gamma\) is the boundary of the domain \(\Omega\) and \(\hat n_i\) is the normal unit vector of the boundary surface. \Cref{eq:weakUCNS_IBP} represents the \textbf{Weak UCNS in IBP Form}.

    \subsection{Domain Discretization}
        Define nodes, points, and elements. 

        \subsubsection{Shape Function Decomposition}
        Define a set of functions \(N\) that are a basis for the weight functions. In the case of the \textbf{Galerkin Form}, the basis/shape functions \(N\) are the same for the weight function and the solution function. We can decompose some constant \(\phi\) into

        \begin{equation}
            \phi(\x) = \sum_{A=1}^{n_n} N_A(\x) \phi_A
        \end{equation}

        where \(A\) is the index of each node and \(\phi_A\) is the value of \(\phi\) at each node \(A\). This decomposition can be extrapolated to our unknowns: \(\U\), \(\U_{,t}\), and \(\W\):

        \begin{subequations}
           \begin{align}
                \U(\x) &= \sum_{A=1}^{n_n} N_A(\x) \U_A \\
                \U_{,t}(\x) &= \sum_{A=1}^{n_n} N_A(\x) \U_{A,t} \\
                \W(\x) &= \sum_{B=1}^{n_n} N_B(\x) \W_B 
           \end{align} 
        \end{subequations}

        Since we are working in Galerkin, \(N_A(\x) = N_B(\x) \) for \(A=B\) (ie, at the same node). 





\end{document}